<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Using and configuring WeeChat, making IRC mostly painless :: agren.cc</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="There&rsquo;s a simplicity to IRC compared to most &ldquo;modern&rdquo; alternatives that is easy to love. This article is about how to set up the basics of the WeeChat IRC client.
" />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://agren.cc/p/using-weechat/" />





  
  <link rel="stylesheet" href="https://agren.cc/css/fonts.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/main.min.f45962ce6ffdd2247db17a705d0190d5ca08e6b0757015b1061b0594e50b535b.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/prism.min.3080cbc8607b8ded79eec60a46295119aef4486a3a2d88c9ddc57ee285ca19ca.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/syntax.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/terminal.min.795e2bed278f30aabee20511815271033ceb14e4a8348f8501a71429808fa574.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/buttons.min.2bc533403a27dfe0e93105a92502b42ce4587e2e4a87d9f7d349e51e16e09478.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/code.min.00125962708925857e7b66dbc58391d55be1191a3d0ce2034de8c9cd2c481c36.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/footer.min.2e3eb191baee58dd05a9f0104ac1fab0827bca7c64dafe0b2579f934c33a1d69.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/header.min.b6fb4423cf82a9f9d7abc9cd010223fa3d70a6526a3f28f8e17d814c06e18f9e.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/menu.min.83637a90d903026bc280d3f82f96ceb06c5fc72b7c1a8d686afb5bbf818a29f7.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/pagination.min.82f6400eae7c7c6dc3c866733c2ec0579e4089608fea69400ff85b3880aa0d3c.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/post.min.fc74ca360273c1d828da3c02b8174eba435607b369d98418ccc6f2243cd4e75d.css">

  
  <link rel="stylesheet" href="https://agren.cc/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="https://agren.cc/favicon.png">
<link rel="apple-touch-icon" href="https://agren.cc/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Using and configuring WeeChat, making IRC mostly painless">
<meta property="og:description" content="There&rsquo;s a simplicity to IRC compared to most &ldquo;modern&rdquo; alternatives that is easy to love. This article is about how to set up the basics of the WeeChat IRC client.
" />
<meta property="og:url" content="https://agren.cc/p/using-weechat/" />
<meta property="og:site_name" content="agren.cc" />

  <meta property="og:image" content="https://agren.cc/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2025-01-18 12:00:00 &#43;0200 &#43;0200" />









<meta name="fediverse:creator" content="@linus@telegrafverket.cc" />
<link rel="me" href="https://telegrafverket.cc/@linus" />


</head>
<body>


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    agren.cc
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;â–¾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/about/index.html">about</a></li>
        
      
        
          <li><a href="https://telegrafverket.cc/@linus">mastodon</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/about/index.html" >about</a></li>
        
      
        
          <li><a href="https://telegrafverket.cc/@linus" >mastodon</a></li>
        
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://agren.cc/p/using-weechat/">Using and configuring WeeChat, making IRC mostly painless</a>
  </h1>
  <div class="post-meta"><time class="post-date">2025-01-18</time></div>

  
    <span class="post-tags">
      
      #<a href="https://agren.cc/tags/freebsd/">freebsd</a>&nbsp;
      
      #<a href="https://agren.cc/tags/linux/">linux</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <p>There&rsquo;s a simplicity to IRC compared to most &ldquo;modern&rdquo; alternatives that
is easy to love. This article is about how to set up the basics of
the WeeChat IRC client.</p>
<p>First of all, a short tangent regarding the name: <em>WeeChat</em> (the IRC
client) was released in 2003, predating the Chinese instant messaging
app <a href="https://en.wikipedia.org/wiki/WeChat">WeChat</a> by about eight years.
This, of course, does not matter much since the latter has more than
1.2B users (2022), which means confusion is unavoidable. It might be
unnecessary to state it, but they have no connection to eachother.</p>
<h2 id="installing-weechat">Installing WeeChat<a href="#installing-weechat" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>It&rsquo;s pretty likely that your *NIX package manager already offers
WeeChat, so using <code>pacman</code>, <code>dnf</code>, <code>apt</code> or <code>pkg</code> should be sufficient.
We&rsquo;ll also be using <code>tmux</code> to keep the session alive, so for Debian:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">apt install weechat tmux
</span></span></code></pre></div><h2 id="first-launch">First launch<a href="#first-launch" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>If you&rsquo;ve never used <code>tmux</code> before, you only need to know that:</p>
<ul>
<li><code>tmux</code> starts a new session</li>
<li><code>CTRL+b</code> followed by <code>d</code> will detach your session, keeping it alive in
the background.</li>
<li><code>tmux a</code> will attach your tmux session again, assuming there is only one.</li>
</ul>
<p>So let&rsquo;s start by creating our first tmux session, then start WeeChat
inside it:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">tmux
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">weechat
</span></span></code></pre></div><p>When starting WeeChat the first time, you&rsquo;ll be in the <code>core</code> buffer,
which just means you haven&rsquo;t configured any IRC servers yet to switch
between. Let&rsquo;s do that now.</p>
<h2 id="configuring-irc-servers">Configuring IRC servers<a href="#configuring-irc-servers" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>Let&rsquo;s set up a connection to
<a href="https://en.wikipedia.org/wiki/Libera_Chat">Libera.Chat</a>, a network
founded in 2021 by former staff at Freenode. It&rsquo;s used by a wide variety
of open source projects, and is a good place to start.</p>
<p>This part is also covered pretty well in the <a href="https://weechat.org/files/doc/stable/weechat_quickstart.en.html#add_irc_server">WeeChat
Quickstart</a>.</p>
<p>First, let&rsquo;s add Libera as a server. As with any IRC network, it&rsquo;s best
to check with them directly what servers you can use, which Libera
provides in their <a href="https://libera.chat/guides/connect">Connecting to
Libera.Chat</a> article:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Hostname</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Default</td>
          <td style="text-align: left">irc.libera.chat</td>
      </tr>
      <tr>
          <td style="text-align: left">Europe</td>
          <td style="text-align: left">irc.eu.libera.chat</td>
      </tr>
      <tr>
          <td style="text-align: left">US &amp; Canada</td>
          <td style="text-align: left">irc.us.libera.chat</td>
      </tr>
      <tr>
          <td style="text-align: left">Australia and New Zealand</td>
          <td style="text-align: left">irc.au.libera.chat</td>
      </tr>
      <tr>
          <td style="text-align: left">East Asia</td>
          <td style="text-align: left">irc.ea.libera.chat</td>
      </tr>
      <tr>
          <td style="text-align: left">IPv4 only</td>
          <td style="text-align: left">irc.ipv4.libera.chat</td>
      </tr>
      <tr>
          <td style="text-align: left">IPv6 only</td>
          <td style="text-align: left">irc.ipv6.libera.chat</td>
      </tr>
  </tbody>
</table>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Description</th>
          <th style="text-align: left">Ports</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Plain-text</td>
          <td style="text-align: left">6665-6667, 8000-8002</td>
      </tr>
      <tr>
          <td style="text-align: left">TLS</td>
          <td style="text-align: left">6697, 7000, 7070</td>
      </tr>
  </tbody>
</table>
<p>I&rsquo;m in the EU, and I like TLS, so I&rsquo;ll do:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/server add libera irc.eu.libera.chat/6697
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">irc: server added: libera
</span></span></code></pre></div><p>Normally, you should be able to add <code>-tls</code> to this command, but for some
reason I couldn&rsquo;t get it to work, but that&rsquo;s fine: this is an excellent
reason to go through configuration of existing servers.</p>
<h3 id="reconfigure-the-libera-server">Reconfigure the &rsquo;libera&rsquo; server<a href="#reconfigure-the-libera-server" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Run the following to get a verbose output of all attributes set for all
servers, and use PGUP/PGDOWN to scroll:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/server listfull
</span></span></code></pre></div><p>Along lots of other attributes, you&rsquo;ll see:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Server: libera [not connected]
</span></span><span class="line"><span class="cl">  addresses. . . . . . : &#39;irc.eu.libera.chat/6697&#39;
</span></span><span class="line"><span class="cl">  (...)
</span></span><span class="line"><span class="cl">  ssl. . . . . . . . . :   (off)
</span></span></code></pre></div><p>We know this should be a secure connection, so let&rsquo;s change that value.
These attributes are all available via <code>irc.server.libera</code>, where
<code>libera</code> is the name you chose for the server, so the <code>ssl</code> value is set
with:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/set irc.server.libera.ssl on
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Option changed: irc.server.libera.ssl = on  (default if null: off)
</span></span></code></pre></div><p>This will be useful to know later when we want to set things like
<code>autoconnect</code>, <code>autojoin</code> and so on.</p>
<h3 id="choosing-a-name">Choosing a name<a href="#choosing-a-name" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Before connecting, we need to choose a name. Unlike what some may be
used to, the nickname on IRC is set by the user themselves on every
connection, and must be &ldquo;reserved&rdquo; by registration and authentication.
WeeChat can handle this for us, but the risk of collision with yourself
or someone that has rudely stolen your name means that setting up
alternate names is common practice. Assuming your preferred name is
<code>deppenleerzeichen</code> on this network, you may want to at least set:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/set irc.server.libera.nicks &#34;deppenleerzeichen,deppenleerzeichen_&#34;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Option changed: irc.server.libera.nicks = &#34;deppenleerzeichen,deppenleerzeichen_&#34;  (default if null: &#34;root,root1,root2,root3,root4&#34;)
</span></span></code></pre></div><p>In this case, I&rsquo;m running WeeChat in a container as root, which is why the
default name is variants of &ldquo;root&rdquo; (the user running weechat).</p>
<h3 id="registering-your-name">Registering your name<a href="#registering-your-name" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>We&rsquo;re now ready to connect, with our completely unregistered and made up
name:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/connect libera
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">(...)
</span></span><span class="line"><span class="cl">libera  -- | User mode [+Ziw] by deppenleerzeiche
</span></span></code></pre></div><p>The <a href="https://libera.chat/guides/usermodes">user mode</a> <code>+Z</code> tells us that
a secure connection was established successfully.</p>
<p>At this point, we could just join channels and start chatting away, but:</p>
<ul>
<li>We want our name to be registered, not only so we can know it won&rsquo;t be
used by other people, but also because some channels require it.</li>
<li>It hides your &ldquo;host&rdquo;, meaning that if you run <code>/whois your_name</code>, your
reverse DNS will be replaced by <code>user/your_name</code>, which is nice.</li>
<li>We also want to set up authorization and channel joins automatically,
so we don&rsquo;t have to manually do this every time WeeChat starts back up
(because you&rsquo;ll forget how).</li>
</ul>
<p><a href="https://libera.chat/guides/registration">Nickname Registration</a> in
libera&rsquo;s own documentation tells us how to do it:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/msg NickServ REGISTER some_decent_password youremail@example.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">An email containing nickname activation instructions has been sent to REDACTED.
</span></span><span class="line"><span class="cl">Please check the address if you don&#39;t receive it. If it is incorrect, DROP then REGISTER again.
</span></span><span class="line"><span class="cl">If you do not complete registration within one day, your nickname will expire.
</span></span><span class="line"><span class="cl">deppenleerzeiche is now registered to REDACTED.
</span></span></code></pre></div><p>The e-mail you receive will contain a command you can run that looks
like:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/msg NickServ VERIFY REGISTER deppenleerzeiche something
</span></span></code></pre></div><p>Just run that, and you&rsquo;re done. Now that we have registered our name, we
can set up authentication and channel joins to happen automatically.</p>
<h3 id="sasl-authentication">SASL authentication<a href="#sasl-authentication" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Back in the bad old days, identification was done by doing something
like <code>/msg nickserv identify</code>, which just sent a simple message to the
&ldquo;nickserv&rdquo; user (a bot) which then proved your identity. These days,
when supported, you should use SASL, so we&rsquo;re doing that.</p>
<p>Simply set <code>sasl_username</code> and <code>sasl_password</code> to your nickname and
chosen password respectively:</p>
<p><strong>WARNING</strong>: If you are setting this up in a shared environment, this is
not a secure way to store your password. Refer to <a href="https://weechat.org/files/doc/stable/weechat_quickstart.en.html#irc_server_options">Set custom IRC server
options</a>
and use <code>/secure passphrase</code> and <code>/secure set</code> to set up a secure
variable like <code>${sec.data.libera_password}</code> instead.</p>
<p>The below is a bit simpler, but should only be used on single user systems.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/set irc.server.libera.sasl_username &#34;mynick&#34;
</span></span><span class="line"><span class="cl">/set irc.server.libera.sasl_password &#34;xxxxxxx&#34;
</span></span></code></pre></div><p>If you <code>/disconnect libera</code> then <code>/connect libera</code>, somewhere in the
output you should hopefully see:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">You are now logged in as deppenleerzeiche (deppenleerzeiche!root@user/deppenleerzeiche)
</span></span><span class="line"><span class="cl">deppenleerzeiche SASL authentication successful
</span></span></code></pre></div><h3 id="final-touches">Final touches<a href="#final-touches" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>Since we now have automatic authentication, the only thing left is to
set up autoconnect rather than having to do <code>/connect</code>, and what
channels we want to join. Autoconnect is just one of the attributes we
saw earlier with <code>/server listfull</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/set irc.server.libera.autoconnect on
</span></span></code></pre></div><p>You can verify that this works by doing <code>/exit</code>, which will kill
WeeChat, then running <code>weechat</code> again.</p>
<p>The easiest way to set up auto-join of channels in my opinion is to
simply join the channels you want, for example:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/join #libera
</span></span></code></pre></div><p>To switch between channels and the &ldquo;status&rdquo; window, just do ALT+UP/DOWN,
or ALT+N where N is the number displayed on the left. When you&rsquo;re in the
status window, you can switch between server-specific buffers and the
core buffer by pressing CTRL+x. You&rsquo;ll notice that highlight colors
change (to show what lines are relevant to your current buffer), and
that <code>irc/libera</code> or <code>core</code> is displayed in the bottom left.</p>
<p>This is relevant because some commands only make sense in the context of
a single server, like the one we&rsquo;re going to run now:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/autojoin apply
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">libera     | Autojoin changed from empty value to &#34;#libera&#34;
</span></span></code></pre></div><p>This simply adds all the channels you are currently in to your autojoin
list. If you run this in the &ldquo;core&rdquo; context, you&rsquo;ll instead get:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">weechat =!= | irc: command &#34;autojoin&#34; must be executed on irc buffer (server, channel or private)
</span></span></code></pre></div><p>You can now again run <code>/exit</code>, start WeeChat back up, and notice that
both authentication and channel joins happen automatically.</p>
<h3 id="summary">Summary<a href="#summary" class="hanchor" ariaLabel="Anchor">#</a> </h3>
<p>We have:</p>
<ul>
<li>Installed WeeChat</li>
<li>Configured connecting to an IRC server over TLS</li>
<li>Registered our name, and set up automatic authentication</li>
<li>Set up auto-join for the channels we want</li>
</ul>
<p>There&rsquo;s obviously a lot more you can do with WeeChat, if you have any
suggestions or feedback feel free to get back to me via Mastodon
<a href="https://telegrafverket.cc/@linus">@linus@telegrafverket.cc</a> or e-mail.</p>

      </div></div>

  
    
<div class="pagination">
  <div class="pagination__title">
    <span class="pagination__title-h">Read other posts</span>
    <hr />
  </div>
  <div class="pagination__buttons">
    
      <a href="https://agren.cc/p/systemd-tailscale/" class="button inline prev">
        Making tailscaled dependable for sshd and other services
      </a>
    
    
      ::
    
    
      <a href="https://agren.cc/p/flatcar-on-incus/" class="button inline next">
        Flatcar Linux VM under Incus on Debian
      </a>
    
  </div>
</div>


  

  
    

  
</article>

  </div>

  
    <footer class="footer">
    <div class="footer__inner">
        <span>:: All text written by me is <a
        href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA
        4.0</a>, credit "agren.cc"<br/>:: Rendered with <a
        href="https://gohugo.io/">Hugo</a> and the <a
        href="https://github.com/panr/hugo-theme-terminal"
        target="_blank">terminal theme</a>.</span>
        </div>
    </div>
  </footer>

  
  

  

  <script type="text/javascript" src="/bundle.min.js"></script>

  
  


  
</div>

</body>
</html>
